"use strict";(self["webpackChunkinspector_sys"]=self["webpackChunkinspector_sys"]||[]).push([[350],{5350:function(e,l,a){a.r(l),a.d(l,{default:function(){return D}});var t=a(3396),o=a(4870),u=a(7139),n=a(2748),i=a(1298);function d(){return(0,i.Z)({url:"databaseget",method:"get"})}function p(e){return(0,i.Z)({url:"tableDataChange",method:"post",data:e})}function r(e){return(0,i.Z)({url:"deletetableimf",method:"post",data:e})}function c(e){return(0,i.Z)({url:"uploadtableimf",method:"post",data:e,headers:{"Content-Type":"mutipart/form-data"}})}var s=a(7178),m=a(6e3),w=a(6666),f=a(2261),v=a(7947);const W=e=>((0,t.dD)("data-v-460fceb7"),e=e(),(0,t.Cn)(),e),g={class:"table-block"},U={class:"dialog-footer"},_=W((()=>(0,t._)("div",{class:"el-upload__tip"},"仅能上传xlsx文件",-1)));var h={__name:"index",setup(e){const l=(0,o.qj)({tableData:[],formData:{DrawingNo:"",WeldNo:"",PipeNo:"",Size:"",MaterialId:"",ZuDuiDate:[],ZuDuiInspectDate:[],WeldingDate:[],AppearanceInspectDate:[],AppearanceResult:""},formRules:{DrawingNo:[{required:!0,message:"请输入图纸号",trigger:"blur"}],WeldNo:[{required:!0,message:"请输入焊口号",trigger:"blur"}]},uploadForm:{user:"test"}}),{tableData:a,formData:W,uploadForm:h}=(0,o.BK)(l),S=(0,o.iH)([]),b=(0,o.iH)(1),D=(0,o.iH)(10),y=(0,o.iH)(null),k=(0,o.iH)(!1);async function V(){k.value=!0,await d().then((e=>200===e.status?(S.value=e.data,C(),Promise.resolve()):Promise.reject(e))).catch((e=>{s.z8.error(e),console.log(e)})),k.value=!1}V();const N=(0,o.iH)(void 0);function C(e){N.value||(N.value=e);let l=N.value?N.value:S.value;a.value=l.slice((b.value-1)*D.value,b.value*D.value),y.value=l.length}function x(e){b.value=e,C()}function I(e){D.value=e,b.value=1,C()}const z=(0,o.iH)(void 0),H=(0,o.iH)(null),E=(0,o.iH)(!1);function B(e){z.value="修改表单",E.value=!0;const l=JSON.parse(JSON.stringify(e));W.value=l,H.value=l}function Z(e){m.T.confirm(`确定要删除图纸号为${e.DrawingNo||P.value.map((e=>e.DrawingNo))}的数据吗？`,"系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{r({tableData:e}).then((e=>{console.log(e),(0,s.z8)({type:"success",message:"删除成功"})})).catch((e=>{console.log(e)}))})).catch((()=>{}))}const A=(0,o.iH)(void 0);function M(){N.value=null,console.log(A.value,"queryDAta");let e=S.value.filter((e=>e.DrawingNo==A.value||e.DrawingNo.includes(A.value)));a.value=e,y.value=e.length,C(e)}function R(){A.value=void 0,N.value=null,V()}const P=(0,o.iH)([]);function T(e,l){P.value=e}function j(e){P.value=e}function q(){z.value="新增表单",E.value=!0,W.value={DrawingNo:"",WeldNo:"",PipeNo:"",Size:"",MaterialId:"",ZuDuiDate:[],ZuDuiInspectDate:[],WeldingDate:[],AppearanceInspectDate:[],AppearanceResult:""}}const F=(0,o.iH)(),$=(0,o.iH)(!1);async function J(e){e&&await e.validate((async(e,l)=>{if(e){const e=(0,o.IU)(W.value);e.editable=!0;for(const l in e)e[l]!==H.value[l]?e[l+"_edible"]=!0:e[l+"_edible"]=!1;e.type="edit";try{$.value=!0;let l=await p({tableData:e});s.z8.success(l.data.Note),$.value=!1,E.value=!1,V()}catch(a){console.log(a),s.z8.error(a)}}else console.log("error submit!",l)}))}const O=(0,o.iH)(!1);function Q(){O.value=!0}function G(e){(0,i.W)(e,`summary_${(new Date).toLocaleDateString("zh-CN",{year:"2-digit",month:"2-digit",day:"2-digit"})}.xlsx`)}const K=(0,o.iH)(!1);function L(){K.value=!0}const Y=(0,o.iH)(),X=(0,o.iH)([]);function ee(e){Y.value=e;let l=e.name.split(".");return"xls"===l[1]||"xlsx"===l[1]||"csv"===l[1]?e:((0,w.bM)({title:"上传失败",message:"仅能上传excel格式文件！",type:"error"}),X.value=[],Y.value="",!1)}function le(){(0,w.bM)({title:"上传失败",message:"单次仅能上传一个文件！",type:"error"})}const ae=(0,o.iH)(!1),te=(0,o.iH)();function oe(){if(!Y.value)return void s.z8.error("上传文件不能为空！");ae.value=!0,console.log(Y.value);let e=new FormData;e.append("file",Y.value.raw),e.append("user","test"),c(e).then((e=>{console.log(e),(0,w.bM)({title:"上传成功",message:`${e.data.Note}`,type:"success"}),ae.value=!1,X.value=[],Y.value=""})).catch((e=>{(0,w.bM)({title:"上传失败",message:`${e.data.Note}`,type:"error"})}))}return(e,i)=>{const d=(0,t.up)("el-input"),p=(0,t.up)("el-form-item"),r=(0,t.up)("el-form"),c=(0,t.up)("el-col"),s=(0,t.up)("el-table-column"),m=(0,t.up)("el-table"),w=(0,t.up)("el-pagination"),h=(0,t.up)("el-row"),S=(0,t.up)("el-option"),V=(0,t.up)("el-select"),N=(0,t.up)("el-date-picker"),C=(0,t.up)("el-radio"),H=(0,t.up)("el-radio-group"),Y=(0,t.up)("el-upload"),ue=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(h,{gutter:30},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{span:24},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{inline:!0,"label-width":"55px"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{label:"单管号"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{clearable:"",style:{width:"230px"},modelValue:A.value,"onUpdate:modelValue":i[0]||(i[0]=e=>A.value=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(f.ElButton),{icon:(0,o.SU)(n.olm),type:"primary",onClick:M},{default:(0,t.w5)((()=>[(0,t.Uk)("搜索")])),_:1},8,["icon"])])),_:1}),(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(f.ElButton),{icon:(0,o.SU)(n.Ufu),onClick:R},{default:(0,t.w5)((()=>[(0,t.Uk)("重置")])),_:1},8,["icon"])])),_:1}),(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(f.ElButton),{icon:(0,o.SU)(n.v37),plain:"",type:"primary",onClick:q},{default:(0,t.w5)((()=>[(0,t.Uk)("新增")])),_:1},8,["icon"])])),_:1}),(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(f.ElButton),{icon:(0,o.SU)(n.I8b),plain:"",type:"success",disabled:!(1==P.value.length),onClick:i[1]||(i[1]=e=>B(P.value[0]))},{default:(0,t.w5)((()=>[(0,t.Uk)("修改")])),_:1},8,["icon","disabled"])])),_:1}),(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(f.ElButton),{icon:(0,o.SU)(n.HG3),plain:"",type:"danger",disabled:!(P.value.length>=1),onClick:Z},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:1},8,["icon","disabled"])])),_:1})])),_:1})])),_:1}),(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(f.ElButton),{icon:(0,o.SU)(n.UWx),plain:"",type:"success",onClick:Q},{default:(0,t.w5)((()=>[(0,t.Uk)("数据下载")])),_:1},8,["icon"]),(0,t.Wm)((0,o.SU)(f.ElButton),{icon:(0,o.SU)(n.AQM),plain:"",type:"primary",onClick:L},{default:(0,t.w5)((()=>[(0,t.Uk)("图纸上传")])),_:1},8,["icon"])])),_:1}),(0,t.Wm)(c,{span:24},{default:(0,t.w5)((()=>[(0,t._)("div",g,[(0,t.wy)(((0,t.wg)(),(0,t.j4)(m,{data:(0,o.SU)(a),"element-loading-text":"加载中...",onSelect:T,onSelectAll:j,height:"750"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{type:"selection",width:"55"}),(0,t.Wm)(s,{type:"index",width:"55",label:"序号",align:"center"}),(0,t.Wm)(s,{label:"图纸号","show-overflow-tooltip":"",align:"center",prop:"DrawingNo",width:"220"}),(0,t.Wm)(s,{label:"焊口号","show-overflow-tooltip":"",prop:"WeldNo",align:"center",width:"80"}),(0,t.Wm)(s,{label:"单管号","show-overflow-tooltip":"",prop:"PipeNo",align:"center",width:"220"}),(0,t.Wm)(s,{label:"管径","show-overflow-tooltip":"",prop:"Size",align:"center",width:"55"}),(0,t.Wm)(s,{label:"材质","show-overflow-tooltip":"",prop:"MaterialId",align:"center",width:"55"}),(0,t.Wm)(s,{label:"组对日期","show-overflow-tooltip":"",prop:"ZuDuiDate",align:"center"}),(0,t.Wm)(s,{label:"组队检验日期","show-overflow-tooltip":"",prop:"ZuDuiInspectDate",align:"center"}),(0,t.Wm)(s,{label:"焊接日期","show-overflow-tooltip":"",prop:"WeldingDate",align:"center"}),(0,t.Wm)(s,{label:"外观检验日期","show-overflow-tooltip":"",prop:"AppearanceInspectDate",align:"center"}),(0,t.Wm)(s,{label:"外观检验结果","show-overflow-tooltip":"",prop:"AppearanceResult",align:"center",width:"120"}),(0,t.Wm)(s,{label:"操作",align:"center"},{default:(0,t.w5)((e=>[(0,t.Wm)((0,o.SU)(f.ElButton),{icon:"Edit",link:"",type:"primary",disabled:0==e.row.isExchange,onClick:l=>B(e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("修改 ")])),_:2},1032,["disabled","onClick"]),(0,t.Wm)((0,o.SU)(f.ElButton),{icon:"Delete",link:"",type:"primary",disabled:0==e.row.isExchange,onClick:l=>Z(e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("删除 ")])),_:2},1032,["disabled","onClick"])])),_:1})])),_:1},8,["data"])),[[ue,k.value]]),(0,t.Wm)(w,{"current-page":b.value,"onUpdate:currentPage":i[2]||(i[2]=e=>b.value=e),"page-size":D.value,"onUpdate:pageSize":i[3]||(i[3]=e=>D.value=e),"page-sizes":[10,20,50,100],small:e.small,background:!0,layout:"total, sizes, prev, pager, next, jumper",total:y.value,onSizeChange:I,onCurrentChange:x,style:{"margin-top":"20px"}},null,8,["current-page","page-size","small","total"])])])),_:1})])),_:1}),(0,t.Wm)((0,o.SU)(v.d0),{modelValue:E.value,"onUpdate:modelValue":i[16]||(i[16]=e=>E.value=e),title:z.value,width:"30%"},{footer:(0,t.w5)((()=>[(0,t._)("span",U,[(0,t.Wm)((0,o.SU)(f.ElButton),{onClick:i[14]||(i[14]=e=>E.value=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1}),(0,t.Wm)((0,o.SU)(f.ElButton),{type:"primary",onClick:i[15]||(i[15]=e=>J(F.value)),loading:$.value},{default:(0,t.w5)((()=>[(0,t.Uk)(" 保存 ")])),_:1},8,["loading"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(r,{ref_key:"ruleFormRef",ref:F,model:(0,o.SU)(W),"label-width":"100px",rules:l.formRules},{default:(0,t.w5)((()=>[(0,t.Wm)(h,null,{default:(0,t.w5)((()=>[(0,t.Wm)(c,{span:20},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{label:"图纸号",prop:"DrawingNo"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{modelValue:(0,o.SU)(W).DrawingNo,"onUpdate:modelValue":i[4]||(i[4]=e=>(0,o.SU)(W).DrawingNo=e),placeholder:"请输入图纸号"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,{span:12},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{label:"焊口号",prop:"WeldNo"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{modelValue:(0,o.SU)(W).WeldNo,"onUpdate:modelValue":i[5]||(i[5]=e=>(0,o.SU)(W).WeldNo=e),placeholder:"请输入焊口号"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,{span:12},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{label:"管径",prop:"Size"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{modelValue:(0,o.SU)(W).Size,"onUpdate:modelValue":i[6]||(i[6]=e=>(0,o.SU)(W).Size=e),placeholder:"请输入管径"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,{span:12},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{label:"材质",prop:"MaterialId"},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{modelValue:(0,o.SU)(W).MaterialId,"onUpdate:modelValue":i[7]||(i[7]=e=>(0,o.SU)(W).MaterialId=e),placeholder:"请选择材质"},{default:(0,t.w5)((()=>[(0,t.Wm)(S,{label:"CS",value:"CS"}),(0,t.Wm)(S,{label:"SS",value:"SS"}),(0,t.Wm)(S,{label:"CU/NI",value:"CU/NI"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,{span:20},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{label:"单管号",prop:"PipeNo"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{modelValue:(0,o.SU)(W).PipeNo,"onUpdate:modelValue":i[8]||(i[8]=e=>(0,o.SU)(W).PipeNo=e),placeholder:"请输入单管号"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,{span:16},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{label:"组对日期",prop:"ZuDuiDate"},{default:(0,t.w5)((()=>[(0,t.Wm)(N,{modelValue:(0,o.SU)(W).ZuDuiDate,"onUpdate:modelValue":i[9]||(i[9]=e=>(0,o.SU)(W).ZuDuiDate=e),type:"date",placeholder:"请选择组对日期",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,{span:16},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{label:"组对检验日期",prop:"ZuDuiInspectDate"},{default:(0,t.w5)((()=>[(0,t.Wm)(N,{modelValue:(0,o.SU)(W).ZuDuiInspectDate,"onUpdate:modelValue":i[10]||(i[10]=e=>(0,o.SU)(W).ZuDuiInspectDate=e),type:"date",placeholder:"请选择组对检验日期",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,{span:16},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{label:"焊接日期",prop:"WeldingDate"},{default:(0,t.w5)((()=>[(0,t.Wm)(N,{modelValue:(0,o.SU)(W).WeldingDate,"onUpdate:modelValue":i[11]||(i[11]=e=>(0,o.SU)(W).WeldingDate=e),type:"date",placeholder:"请选择焊接日期",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,{span:16},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{label:"外观检验日期",prop:"AppearanceInspectDate"},{default:(0,t.w5)((()=>[(0,t.Wm)(N,{modelValue:(0,o.SU)(W).AppearanceInspectDate,"onUpdate:modelValue":i[12]||(i[12]=e=>(0,o.SU)(W).AppearanceInspectDate=e),type:"date",placeholder:"请选择外观检验日期",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(c,{span:24},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{label:"外观检验结果",prop:"AppearanceResult"},{default:(0,t.w5)((()=>[(0,t.Wm)(H,{modelValue:(0,o.SU)(W).AppearanceResult,"onUpdate:modelValue":i[13]||(i[13]=e=>(0,o.SU)(W).AppearanceResult=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{border:"",label:1},{default:(0,t.w5)((()=>[(0,t.Uk)("合格")])),_:1}),(0,t.Wm)(C,{border:"",label:2},{default:(0,t.w5)((()=>[(0,t.Uk)("不合格")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),(0,t.Wm)((0,o.SU)(v.d0),{class:"uploadDialog",modelValue:K.value,"onUpdate:modelValue":i[17]||(i[17]=e=>K.value=e),title:"图纸上传"},{footer:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(f.ElButton),{type:"success",onClick:oe,loading:ae.value},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(ae.value?"上传中...":"上传服务器"),1)])),_:1},8,["loading"])])),default:(0,t.w5)((()=>[(0,t.Wm)(Y,{ref_key:"uploadRef",ref:te,class:"upload-demo","on-change":ee,"on-exceed":le,"list-type":"picture","auto-upload":!1,limit:"1","file-list":X.value},{trigger:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(f.ElButton),{type:"primary"},{default:(0,t.w5)((()=>[(0,t.Uk)("选取文件")])),_:1})])),tip:(0,t.w5)((()=>[_])),_:1},8,["file-list"])])),_:1},8,["modelValue"]),(0,t.Wm)((0,o.SU)(v.d0),{modelValue:O.value,"onUpdate:modelValue":i[22]||(i[22]=e=>O.value=e),title:"数据下载"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,null,{default:(0,t.w5)((()=>[(0,t.Wm)(c,{span:12},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{label:"时间范围"},{default:(0,t.w5)((()=>[(0,t.Wm)(N,{modelValue:e.value2,"onUpdate:modelValue":i[18]||(i[18]=l=>e.value2=l),type:"daterange","unlink-panels":"","range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date",shortcuts:e.shortcuts,size:e.size},null,8,["modelValue","shortcuts","size"])])),_:1})])),_:1}),(0,t.Wm)(c,{span:12},{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(f.ElButton),{icon:(0,o.SU)(n.UWx),plain:"",type:"warning",onClick:i[19]||(i[19]=e=>G("downloaddwrfile"))},{default:(0,t.w5)((()=>[(0,t.Uk)("DWR下载")])),_:1},8,["icon"]),(0,t.Wm)((0,o.SU)(f.ElButton),{icon:(0,o.SU)(n.UWx),plain:"",type:"warning",onClick:i[20]||(i[20]=e=>G("downloadsumfile"))},{default:(0,t.w5)((()=>[(0,t.Uk)("焊口信息汇总表下载")])),_:1},8,["icon"]),(0,t.Wm)((0,o.SU)(f.ElButton),{icon:(0,o.SU)(n.UWx),plain:"",type:"warning",onClick:i[21]||(i[21]=e=>G("downloadsumfile"))},{default:(0,t.w5)((()=>[(0,t.Uk)("VT信息下载")])),_:1},8,["icon"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}},S=a(89);const b=(0,S.Z)(h,[["__scopeId","data-v-460fceb7"]]);var D=b}}]);
//# sourceMappingURL=350.74a97f64.js.map