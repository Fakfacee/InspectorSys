"use strict";(self["webpackChunkinspector_sys"]=self["webpackChunkinspector_sys"]||[]).push([[534],{9534:function(e,l,a){a.r(l),a.d(l,{default:function(){return h}});a(7658);var t=a(3396),o=a(4870),u=a(2748),n=a(1298);function i(){return(0,n.Z)({url:"databaseget",method:"get"})}function d(e){return(0,n.Z)({url:"tableDataChange",method:"post",data:e})}function p(e){return(0,n.Z)({url:"deletetableimf",method:"post",data:e})}var r=a(7178),c=a(6e3),s=a(2261),m=a(7947);const w=e=>((0,t.dD)("data-v-7c1ad65a"),e=e(),(0,t.Cn)(),e),f={class:"table-block"},g={class:"dialog-footer"},W=w((()=>(0,t._)("div",{class:"el-upload__tip"},"仅支持jpg格式文件且大小大于2MB",-1)));var v={__name:"index",setup(e){const l=(0,o.qj)({tableData:[],formData:{DrawingNo:"",WeldNo:"",PipeNo:"",Size:"",MaterialId:"",ZuDuiDate:[],ZuDuiInspectDate:[],WeldingDate:[],AppearanceInspectDate:[],AppearanceResult:""},formRules:{DrawingNo:[{required:!0,message:"请输入图纸号",trigger:"blur"}],WeldNo:[{required:!0,message:"请输入焊口号",trigger:"blur"}],ZuDuiDate:[{type:"date",required:!0,message:"请选择组对日期",trigger:"change"}],WeldingDate:[{type:"date",required:!0,message:"请选择焊接日期",trigger:"change"}]},uploadForm:{user:"test"}}),{tableData:a,formData:w,uploadForm:v}=(0,o.BK)(l),U=(0,o.iH)([]),_=(0,o.iH)(1),h=(0,o.iH)(10),b=(0,o.iH)(null),D=(0,o.iH)(!1);async function S(){D.value=!0,await i().then((e=>200===e.status?(U.value=e.data,k(),Promise.resolve()):Promise.reject(e))).catch((e=>{r.z8.error(e),console.log(e)})),D.value=!1}S();const y=(0,o.iH)(void 0);function k(e){y.value||(y.value=e);let l=y.value?y.value:U.value;a.value=l.slice((_.value-1)*h.value,_.value*h.value),b.value=l.length}function V(e){_.value=e,k()}function N(e){h.value=e,_.value=1,k()}const C=(0,o.iH)(void 0),I=(0,o.iH)(null),z=(0,o.iH)(!1);function B(e){C.value="修改表单",z.value=!0;const l=JSON.parse(JSON.stringify(e));w.value=l,I.value=l}function H(e){c.T.confirm(`确定要删除图纸号为${e.DrawingNo||A.value.map((e=>e.DrawingNo))}的数据吗？`,"系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{p({tableData:e}).then((e=>{console.log(e),(0,r.z8)({type:"success",message:"删除成功"})})).catch((e=>{console.log(e)}))})).catch((()=>{}))}const Z=(0,o.iH)(void 0);function x(){y.value=null,console.log(Z.value,"queryDAta");let e=U.value.filter((e=>e.DrawingNo==Z.value||e.DrawingNo.includes(Z.value)));a.value=e,b.value=e.length,k(e)}function E(){Z.value=void 0,y.value=null,S()}const A=(0,o.iH)([]);function P(e,l){A.value=e}function R(e){A.value=e}function M(){C.value="新增表单",z.value=!0,w.value={DrawingNo:"",WeldNo:"",PipeNo:"",Size:"",MaterialId:"",ZuDuiDate:[],ZuDuiInspectDate:[],WeldingDate:[],AppearanceInspectDate:[],AppearanceResult:""}}const j=(0,o.iH)(),q=(0,o.iH)(!1);async function F(e){e&&await e.validate((async(e,l)=>{if(e){const e=(0,o.IU)(w.value);e.editable=!0;for(const l in e)e[l]!==I.value[l]?e[l+"_edible"]=!0:e[l+"_edible"]=!1;e.type="edit";try{q.value=!0;let l=await d({tableData:e});r.z8.success(l.data.Note),q.value=!1,z.value=!1,S()}catch(a){console.log(a),r.z8.error(a)}}else console.log("error submit!",l)}))}function J(e){(0,n.W)(e,`summary_${(new Date).toLocaleDateString("zh-CN",{year:"2-digit",month:"2-digit",day:"2-digit"})}.xlsx`)}const T=(0,o.iH)(!1);function G(){T.value=!0}const L=(0,o.iH)([]),O=e=>"image/jpeg"!==e.type?(r.z8.error("文件仅支持JPG格式！"),!1):!(e.size/1024/1024>2)||(r.z8.error("文件最大不能超过 2MB!"),!1);function Q(e){console.log(e),L.value.push(e)}function $(){return"https://cyhdl1ttleyuming.cn/wx2/HZ26-6//uploadtableimf"}return(e,n)=>{const i=(0,t.up)("el-input"),d=(0,t.up)("el-form-item"),p=(0,t.up)("el-form"),r=(0,t.up)("el-col"),c=(0,t.up)("el-table-column"),U=(0,t.up)("el-table"),S=(0,t.up)("el-pagination"),y=(0,t.up)("el-row"),k=(0,t.up)("el-option"),I=(0,t.up)("el-select"),K=(0,t.up)("el-date-picker"),Y=(0,t.up)("el-radio"),X=(0,t.up)("el-radio-group"),ee=(0,t.up)("el-upload"),le=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(y,{gutter:30},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{span:24},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{inline:!0,"label-width":"55px"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"单管号"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{clearable:"",style:{width:"230px"},modelValue:Z.value,"onUpdate:modelValue":n[0]||(n[0]=e=>Z.value=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(s.ElButton),{icon:(0,o.SU)(u.olm),type:"primary",onClick:x},{default:(0,t.w5)((()=>[(0,t.Uk)("搜索")])),_:1},8,["icon"])])),_:1}),(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(s.ElButton),{icon:(0,o.SU)(u.Ufu),onClick:E},{default:(0,t.w5)((()=>[(0,t.Uk)("重置")])),_:1},8,["icon"])])),_:1}),(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(s.ElButton),{icon:(0,o.SU)(u.v37),plain:"",type:"primary",onClick:M},{default:(0,t.w5)((()=>[(0,t.Uk)("新增")])),_:1},8,["icon"])])),_:1}),(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(s.ElButton),{icon:(0,o.SU)(u.I8b),plain:"",type:"success",disabled:!(1==A.value.length),onClick:n[1]||(n[1]=e=>B(A.value[0]))},{default:(0,t.w5)((()=>[(0,t.Uk)("修改")])),_:1},8,["icon","disabled"])])),_:1}),(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(s.ElButton),{icon:(0,o.SU)(u.HG3),plain:"",type:"danger",disabled:!(A.value.length>=1),onClick:H},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:1},8,["icon","disabled"])])),_:1})])),_:1})])),_:1}),(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(s.ElButton),{icon:(0,o.SU)(u.UWx),plain:"",type:"warning",onClick:n[2]||(n[2]=e=>J("downloaddwrfile"))},{default:(0,t.w5)((()=>[(0,t.Uk)("DWR下载")])),_:1},8,["icon"]),(0,t.Wm)((0,o.SU)(s.ElButton),{icon:(0,o.SU)(u.UWx),plain:"",type:"warning",onClick:n[3]||(n[3]=e=>J("downloadsumfile"))},{default:(0,t.w5)((()=>[(0,t.Uk)("焊口信息汇总表下载")])),_:1},8,["icon"]),(0,t.Wm)((0,o.SU)(s.ElButton),{icon:(0,o.SU)(u.AQM),plain:"",type:"primary",onClick:G},{default:(0,t.w5)((()=>[(0,t.Uk)("图纸上传")])),_:1},8,["icon"])])),_:1}),(0,t.Wm)(r,{span:24},{default:(0,t.w5)((()=>[(0,t._)("div",f,[(0,t.wy)(((0,t.wg)(),(0,t.j4)(U,{data:(0,o.SU)(a),"element-loading-text":"加载中...",onSelect:P,onSelectAll:R,height:"750"},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{type:"selection",width:"55"}),(0,t.Wm)(c,{type:"index",width:"55",label:"序号",align:"center"}),(0,t.Wm)(c,{label:"图纸号","show-overflow-tooltip":"",align:"center",prop:"DrawingNo",width:"220"}),(0,t.Wm)(c,{label:"焊口号","show-overflow-tooltip":"",prop:"WeldNo",align:"center",width:"80"}),(0,t.Wm)(c,{label:"单管号","show-overflow-tooltip":"",prop:"PipeNo",align:"center",width:"220"}),(0,t.Wm)(c,{label:"管径","show-overflow-tooltip":"",prop:"Size",align:"center",width:"55"}),(0,t.Wm)(c,{label:"材质","show-overflow-tooltip":"",prop:"MaterialId",align:"center",width:"55"}),(0,t.Wm)(c,{label:"组对日期","show-overflow-tooltip":"",prop:"ZuDuiDate",align:"center"}),(0,t.Wm)(c,{label:"组队检验日期","show-overflow-tooltip":"",prop:"ZuDuiInspectDate",align:"center"}),(0,t.Wm)(c,{label:"焊接日期","show-overflow-tooltip":"",prop:"WeldingDate",align:"center"}),(0,t.Wm)(c,{label:"外观检验日期","show-overflow-tooltip":"",prop:"AppearanceInspectDate",align:"center"}),(0,t.Wm)(c,{label:"外观检验结果","show-overflow-tooltip":"",prop:"AppearanceResult",align:"center",width:"120"}),(0,t.Wm)(c,{label:"操作",align:"center"},{default:(0,t.w5)((e=>[(0,t.Wm)((0,o.SU)(s.ElButton),{icon:"Edit",link:"",type:"primary",disabled:0==e.row.isExchange,onClick:l=>B(e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("修改 ")])),_:2},1032,["disabled","onClick"]),(0,t.Wm)((0,o.SU)(s.ElButton),{icon:"Delete",link:"",type:"primary",disabled:0==e.row.isExchange,onClick:l=>H(e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("删除 ")])),_:2},1032,["disabled","onClick"])])),_:1})])),_:1},8,["data"])),[[le,D.value]]),(0,t.Wm)(S,{"current-page":_.value,"onUpdate:currentPage":n[4]||(n[4]=e=>_.value=e),"page-size":h.value,"onUpdate:pageSize":n[5]||(n[5]=e=>h.value=e),"page-sizes":[10,20,50,100],small:e.small,background:!0,layout:"total, sizes, prev, pager, next, jumper",total:b.value,onSizeChange:N,onCurrentChange:V,style:{"margin-top":"20px"}},null,8,["current-page","page-size","small","total"])])])),_:1})])),_:1}),(0,t.Wm)((0,o.SU)(m.d0),{modelValue:z.value,"onUpdate:modelValue":n[18]||(n[18]=e=>z.value=e),title:C.value,width:"30%","before-close":e.handleClose},{footer:(0,t.w5)((()=>[(0,t._)("span",g,[(0,t.Wm)((0,o.SU)(s.ElButton),{onClick:n[16]||(n[16]=e=>z.value=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1}),(0,t.Wm)((0,o.SU)(s.ElButton),{type:"primary",onClick:n[17]||(n[17]=e=>F(j.value)),loading:q.value},{default:(0,t.w5)((()=>[(0,t.Uk)(" 保存 ")])),_:1},8,["loading"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(p,{ref_key:"ruleFormRef",ref:j,model:(0,o.SU)(w),"label-width":"100px",rules:l.formRules},{default:(0,t.w5)((()=>[(0,t.Wm)(y,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{span:20},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"图纸号",prop:"DrawingNo"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{modelValue:(0,o.SU)(w).DrawingNo,"onUpdate:modelValue":n[6]||(n[6]=e=>(0,o.SU)(w).DrawingNo=e),placeholder:"请输入图纸号"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(r,{span:12},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"焊口号",prop:"WeldNo"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{modelValue:(0,o.SU)(w).WeldNo,"onUpdate:modelValue":n[7]||(n[7]=e=>(0,o.SU)(w).WeldNo=e),placeholder:"请输入焊口号"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(r,{span:12},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"管径",prop:"Size"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{modelValue:(0,o.SU)(w).Size,"onUpdate:modelValue":n[8]||(n[8]=e=>(0,o.SU)(w).Size=e),placeholder:"请输入管径"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(r,{span:12},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"材质",prop:"MaterialId"},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{modelValue:(0,o.SU)(w).MaterialId,"onUpdate:modelValue":n[9]||(n[9]=e=>(0,o.SU)(w).MaterialId=e),placeholder:"请选择材质"},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{label:"CS",value:"CS"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(r,{span:20},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"单管号",prop:"PipeNo"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{modelValue:(0,o.SU)(w).PipeNo,"onUpdate:modelValue":n[10]||(n[10]=e=>(0,o.SU)(w).PipeNo=e),placeholder:"请输入单管号"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(r,{span:16},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"组对日期",prop:"ZuDuiDate"},{default:(0,t.w5)((()=>[(0,t.Wm)(K,{modelValue:(0,o.SU)(w).ZuDuiDate,"onUpdate:modelValue":n[11]||(n[11]=e=>(0,o.SU)(w).ZuDuiDate=e),type:"date",placeholder:"请选择组对日期",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(r,{span:16},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"组对检验日期",prop:"ZuDuiInspectDate"},{default:(0,t.w5)((()=>[(0,t.Wm)(K,{modelValue:(0,o.SU)(w).ZuDuiInspectDate,"onUpdate:modelValue":n[12]||(n[12]=e=>(0,o.SU)(w).ZuDuiInspectDate=e),type:"date",placeholder:"请选择组对检验日期",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(r,{span:16},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"焊接日期",prop:"WeldingDate"},{default:(0,t.w5)((()=>[(0,t.Wm)(K,{modelValue:(0,o.SU)(w).WeldingDate,"onUpdate:modelValue":n[13]||(n[13]=e=>(0,o.SU)(w).WeldingDate=e),type:"date",placeholder:"请选择焊接日期",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(r,{span:16},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"外观检验日期",prop:"AppearanceInspectDate"},{default:(0,t.w5)((()=>[(0,t.Wm)(K,{modelValue:(0,o.SU)(w).AppearanceInspectDate,"onUpdate:modelValue":n[14]||(n[14]=e=>(0,o.SU)(w).AppearanceInspectDate=e),type:"date",placeholder:"请选择外观检验日期",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(r,{span:24},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{label:"外观检验结果",prop:"AppearanceResult"},{default:(0,t.w5)((()=>[(0,t.Wm)(X,{modelValue:(0,o.SU)(w).AppearanceResult,"onUpdate:modelValue":n[15]||(n[15]=e=>(0,o.SU)(w).AppearanceResult=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(Y,{border:"",label:1},{default:(0,t.w5)((()=>[(0,t.Uk)("合格")])),_:1}),(0,t.Wm)(Y,{border:"",label:2},{default:(0,t.w5)((()=>[(0,t.Uk)("不合格")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","before-close"]),(0,t.Wm)((0,o.SU)(m.d0),{class:"uploadDialog",modelValue:T.value,"onUpdate:modelValue":n[20]||(n[20]=e=>T.value=e),"before-close":e.handleClose,title:"图纸上传"},{default:(0,t.w5)((()=>[(0,t.Wm)(ee,{action:$(),"file-list":L.value,"onUpdate:fileList":n[19]||(n[19]=e=>L.value=e),"on-change":Q,"before-upload":O,"list-type":"picture",data:(0,o.SU)(v)},{trigger:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(s.ElButton),{type:"primary"},{default:(0,t.w5)((()=>[(0,t.Uk)("选取文件")])),_:1})])),tip:(0,t.w5)((()=>[W])),_:1},8,["action","file-list","data"])])),_:1},8,["modelValue","before-close"])],64)}}},U=a(89);const _=(0,U.Z)(v,[["__scopeId","data-v-7c1ad65a"]]);var h=_}}]);
//# sourceMappingURL=534.2dc5da15.js.map