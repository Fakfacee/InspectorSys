{"version":3,"file":"js/534.2dc5da15.js","mappings":"0NAEO,SAASA,IACd,OAAOC,EAAAA,EAAAA,GAAQ,CACbC,IAAK,cACLC,OAAQ,OAMZ,CAGO,SAASC,EAAWC,GACzB,OAAOJ,EAAAA,EAAAA,GAAQ,CACbC,IAAK,kBACLC,OAAQ,OACRG,KAAMD,GAEV,CAGO,SAASE,EAAWC,GACzB,OAAOP,EAAAA,EAAAA,GAAQ,CACbC,IAAK,iBACLC,OAAQ,OACRG,KAAME,GAEV,C,mQCkUA,MAAMC,GAAQC,EAAAA,EAAAA,IAAS,CACrBF,UAAW,GACXH,SAAU,CACRM,UAAW,GACXC,OAAQ,GACRC,OAAQ,GACRC,KAAM,GACNC,WAAY,GACZC,UAAW,GACXC,iBAAkB,GAClBC,YAAa,GACbC,sBAAuB,GACvBC,iBAAkB,IAEpBC,UAAW,CACTV,UAAW,CAAC,CAAEW,UAAU,EAAMC,QAAS,SAAUC,QAAS,SAC1DZ,OAAQ,CAAC,CAAEU,UAAU,EAAMC,QAAS,SAAUC,QAAS,SAIvDR,UAAW,CACT,CACES,KAAM,OACNH,UAAU,EACVC,QAAS,UACTC,QAAS,WAIbN,YAAa,CACX,CACEO,KAAM,OACNH,UAAU,EACVC,QAAS,UACTC,QAAS,YAIfE,WAAY,CACVC,KAAM,WAIJ,UAAEnB,EAAS,SAAEH,EAAQ,WAAEqB,IAAeE,EAAAA,EAAAA,IAAOnB,GAE7CoB,GAAUC,EAAAA,EAAAA,IAAI,IACdC,GAAcD,EAAAA,EAAAA,IAAI,GAClBE,GAAWF,EAAAA,EAAAA,IAAI,IACfG,GAAYH,EAAAA,EAAAA,IAAI,MAChBI,GAAUJ,EAAAA,EAAAA,KAAI,GAEpBK,eAAeC,IACbF,EAAQG,OAAQ,QACVrC,IACHsC,MAAMC,GACc,MAAfA,EAAIC,QACNX,EAAQQ,MAAQE,EAAIjC,KACpBmC,IACOC,QAAQC,WACHD,QAAQE,OAAOL,KAE9BM,OAAOC,IACNC,EAAAA,GAAUC,MAAMF,GAChBG,QAAQC,IAAIJ,EAAK,IAErBZ,EAAQG,OAAQ,CAClB,CACAD,IAEA,MAAMe,GAAcrB,EAAAA,EAAAA,SAAIsB,GAExB,SAASX,EAAWY,GACbF,EAAYd,QAAOc,EAAYd,MAAQgB,GAC5C,IAAId,EAAMY,EAAYd,MAAQc,EAAYd,MAAQR,EAAQQ,MAC1D7B,EAAU6B,MAAQE,EAAIe,OACnBvB,EAAYM,MAAQ,GAAKL,EAASK,MACnCN,EAAYM,MAAQL,EAASK,OAE/BJ,EAAUI,MAAQE,EAAIgB,MACxB,CAGA,SAASC,EAAoBC,GAC3B1B,EAAYM,MAAQoB,EACpBhB,GACF,CAGA,SAASiB,EAAiBD,GACxBzB,EAASK,MAAQoB,EACjB1B,EAAYM,MAAQ,EACpBI,GACF,CAGA,MAAMkB,GAAY7B,EAAAA,EAAAA,SAAIsB,GAChBQ,GAAU9B,EAAAA,EAAAA,IAAI,MACd+B,GAAgB/B,EAAAA,EAAAA,KAAI,GAC1B,SAASgC,EAAaC,GACpBJ,EAAUtB,MAAQ,OAClBwB,EAAcxB,OAAQ,EACtB,MAAM2B,EAAeC,KAAKC,MAAMD,KAAKE,UAAUJ,IAC/C1D,EAASgC,MAAQ2B,EACjBJ,EAAQvB,MAAQ2B,CAClB,CAGA,SAASI,EAAaL,GACpBM,EAAAA,EAAaC,QACV,YACCP,EAAIpD,WAAa4D,EAAWlC,MAAMmC,KAAKC,GAASA,EAAK9D,mBAEvD,OACA,CACE+D,kBAAmB,KACnBC,iBAAkB,KAClBlD,KAAM,YAGPa,MAAK,KACJ/B,EAAW,CACTC,UAAWuD,IAEVzB,MAAMC,IACLU,QAAQC,IAAIX,IACZQ,EAAAA,EAAAA,IAAU,CACRtB,KAAM,UACNF,QAAS,QACT,IAEHsB,OAAO+B,IACN3B,QAAQC,IAAI0B,EAAI,GAChB,IAEL/B,OAAM,QACX,CAGA,MAAMgC,GAAY/C,EAAAA,EAAAA,SAAIsB,GACtB,SAAS0B,IACP3B,EAAYd,MAAQ,KACpBY,QAAQC,IAAI2B,EAAUxC,MAAO,aAC7B,IAAIE,EAAMV,EAAQQ,MAAM0C,QACrBN,GACCA,EAAK9D,WAAakE,EAAUxC,OAC5BoC,EAAK9D,UAAUqE,SAASH,EAAUxC,SAEtC7B,EAAU6B,MAAQE,EAClBN,EAAUI,MAAQE,EAAIgB,OACtBd,EAAWF,EACb,CAGA,SAAS0C,IACPJ,EAAUxC,WAAQe,EAClBD,EAAYd,MAAQ,KACpBD,GACF,CAGA,MAAMmC,GAAazC,EAAAA,EAAAA,IAAI,IACvB,SAASoD,EAAsBC,EAAWpB,GACxCQ,EAAWlC,MAAQ8C,CACrB,CAEA,SAASC,EAAmBD,GAC1BZ,EAAWlC,MAAQ8C,CACrB,CAGA,SAASE,IACP1B,EAAUtB,MAAQ,OAClBwB,EAAcxB,OAAQ,EACtBhC,EAASgC,MAAQ,CACf1B,UAAW,GACXC,OAAQ,GACRC,OAAQ,GACRC,KAAM,GACNC,WAAY,GACZC,UAAW,GACXC,iBAAkB,GAClBC,YAAa,GACbC,sBAAuB,GACvBC,iBAAkB,GAEtB,CAGA,MAAMkE,GAAcxD,EAAAA,EAAAA,MACdyD,GAAczD,EAAAA,EAAAA,KAAI,GACxBK,eAAeqD,EAAWC,GACnBA,SACCA,EAAOC,UAASvD,MAAOwD,EAAOC,KAClC,GAAID,EAAO,CACT,MAAME,GAAeC,EAAAA,EAAAA,IAAMzF,EAASgC,OACpCwD,EAAaE,UAAW,EACxB,IAAK,MAAMC,KAAOH,EACZA,EAAaG,KAASpC,EAAQvB,MAAM2D,GACtCH,EAAaG,EAAM,YAAa,EAEhCH,EAAaG,EAAM,YAAa,EAGpCH,EAAapE,KAAO,OACpB,IACE8D,EAAYlD,OAAQ,EACpB,IAAIE,QAAYnC,EAAW,CACzBI,UAAWqF,IAEb9C,EAAAA,GAAUkD,QAAQ1D,EAAIjC,KAAK4F,MAC3BX,EAAYlD,OAAQ,EACpBwB,EAAcxB,OAAQ,EACtBD,GACF,CAAE,MAAOY,GACPC,QAAQC,IAAIF,GACZD,EAAAA,GAAUC,MAAMA,EAClB,CACF,MACEC,QAAQC,IAAI,gBAAiB0C,EAC/B,GAEJ,CAGA,SAASO,EAAajG,IACpBkG,EAAAA,EAAAA,GACElG,EACC,YAAU,IAAImG,MAAOC,mBAAmB,QAAS,CAChDC,KAAM,UACNC,MAAO,UACPC,IAAK,mBAGX,CAGA,MAAMC,GAAsB5E,EAAAA,EAAAA,KAAI,GAChC,SAAS6E,IACPD,EAAoBrE,OAAQ,CAC9B,CAGA,MAAMuE,GAAW9E,EAAAA,EAAAA,IAAI,IACf+E,EAAgBC,GACC,eAAjBA,EAAQrF,MACVsB,EAAAA,GAAUC,MAAM,gBACT,KACE8D,EAAQC,KAAO,KAAO,KAAO,KACtChE,EAAAA,GAAUC,MAAM,kBACT,GAKX,SAASgE,EAAWC,GAClBhE,QAAQC,IAAI+D,GACZL,EAASvE,MAAM6E,KAAKD,EACtB,CA6BA,SAASE,IACP,MAAOC,wDACT,C,o9RCznBA,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://inspector-sys/./src/Network/data.js","webpack://inspector-sys/./src/views/baseData/index.vue","webpack://inspector-sys/./src/views/baseData/index.vue?39eb"],"sourcesContent":["import request from \"./index.js\";\r\n\r\nexport function baseDataList() {\r\n  return request({\r\n    url: \"databaseget\",\r\n    method: \"get\",\r\n    // dataType: \"JSON\",\r\n    // header: {\r\n    //   \"custom-header\": \"Content-Type,Authorization\", //自定义请求头信息\r\n    // },\r\n  });\r\n}\r\n\r\n//数据更新修改\r\nexport function dataUpdate(formData) {\r\n  return request({\r\n    url: \"tableDataChange\",\r\n    method: \"post\",\r\n    data: formData,\r\n  });\r\n}\r\n\r\n//删除\r\nexport function dataDelete(tableData) {\r\n  return request({\r\n    url: \"deletetableimf\",\r\n    method: \"post\",\r\n    data: tableData,\r\n  });\r\n}\r\n\r\n//上传\r\nexport function drawingUpload(data) {\r\n  return request({\r\n    url: \"uploadtableimf\",\r\n    method: \"post\",\r\n    data:data\r\n  })\r\n}\r\n","<template>\r\n  <el-row :gutter=\"30\">\r\n    <el-col :span=\"24\">\r\n      <el-form :inline=\"true\" label-width=\"55px\">\r\n        <el-form-item label=\"单管号\">\r\n          <el-input clearable style=\"width: 230px\" v-model=\"queryData\" />\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button :icon=\"Search\" type=\"primary\" @click=\"handleSearch\"\r\n            >搜索</el-button\r\n          >\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button :icon=\"RefreshLeft\" @click=\"handleReset\">重置</el-button>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button :icon=\"Plus\" plain type=\"primary\" @click=\"handleAddForm\"\r\n            >新增</el-button\r\n          ></el-form-item\r\n        >\r\n        <el-form-item\r\n          ><el-button\r\n            :icon=\"Edit\"\r\n            plain\r\n            type=\"success\"\r\n            :disabled=\"!(selectList.length == 1)\"\r\n            @click=\"handleUpdate(selectList[0])\"\r\n            >修改</el-button\r\n          ></el-form-item\r\n        >\r\n        <el-form-item\r\n          ><el-button\r\n            :icon=\"Delete\"\r\n            plain\r\n            type=\"danger\"\r\n            :disabled=\"!(selectList.length >= 1)\"\r\n            @click=\"handleDelete\"\r\n            >删除</el-button\r\n          ></el-form-item\r\n        >\r\n      </el-form>\r\n    </el-col>\r\n    <el-col>\r\n      <el-button\r\n        :icon=\"Download\"\r\n        plain\r\n        type=\"warning\"\r\n        @click=\"handleExport('downloaddwrfile')\"\r\n        >DWR下载</el-button\r\n      >\r\n      <el-button\r\n        :icon=\"Download\"\r\n        plain\r\n        type=\"warning\"\r\n        @click=\"handleExport('downloadsumfile')\"\r\n        >焊口信息汇总表下载</el-button\r\n      >\r\n      <el-button\r\n        :icon=\"UploadFilled\"\r\n        plain\r\n        type=\"primary\"\r\n        @click=\"openUploadDialog\"\r\n        >图纸上传</el-button\r\n      >\r\n    </el-col>\r\n\r\n    <el-col :span=\"24\">\r\n      <div class=\"table-block\">\r\n        <el-table\r\n          :data=\"tableData\"\r\n          v-loading=\"loading\"\r\n          element-loading-text=\"加载中...\"\r\n          @select=\"handleSelectionChange\"\r\n          @select-all=\"handleSelectionAll\"\r\n          height=\"750\"\r\n        >\r\n          <el-table-column type=\"selection\" width=\"55\" />\r\n          <el-table-column\r\n            type=\"index\"\r\n            width=\"55\"\r\n            label=\"序号\"\r\n            align=\"center\"\r\n          />\r\n          <el-table-column\r\n            label=\"图纸号\"\r\n            show-overflow-tooltip\r\n            align=\"center\"\r\n            prop=\"DrawingNo\"\r\n            width=\"220\"\r\n          />\r\n          <el-table-column\r\n            label=\"焊口号\"\r\n            show-overflow-tooltip\r\n            prop=\"WeldNo\"\r\n            align=\"center\"\r\n            width=\"80\"\r\n          />\r\n          <el-table-column\r\n            label=\"单管号\"\r\n            show-overflow-tooltip\r\n            prop=\"PipeNo\"\r\n            align=\"center\"\r\n            width=\"220\"\r\n          />\r\n          <el-table-column\r\n            label=\"管径\"\r\n            show-overflow-tooltip\r\n            prop=\"Size\"\r\n            align=\"center\"\r\n            width=\"55\"\r\n          />\r\n          <el-table-column\r\n            label=\"材质\"\r\n            show-overflow-tooltip\r\n            prop=\"MaterialId\"\r\n            align=\"center\"\r\n            width=\"55\"\r\n          />\r\n          <el-table-column\r\n            label=\"组对日期\"\r\n            show-overflow-tooltip\r\n            prop=\"ZuDuiDate\"\r\n            align=\"center\"\r\n          />\r\n          <el-table-column\r\n            label=\"组队检验日期\"\r\n            show-overflow-tooltip\r\n            prop=\"ZuDuiInspectDate\"\r\n            align=\"center\"\r\n          />\r\n          <el-table-column\r\n            label=\"焊接日期\"\r\n            show-overflow-tooltip\r\n            prop=\"WeldingDate\"\r\n            align=\"center\"\r\n          />\r\n          <el-table-column\r\n            label=\"外观检验日期\"\r\n            show-overflow-tooltip\r\n            prop=\"AppearanceInspectDate\"\r\n            align=\"center\"\r\n          />\r\n          <el-table-column\r\n            label=\"外观检验结果\"\r\n            show-overflow-tooltip\r\n            prop=\"AppearanceResult\"\r\n            align=\"center\"\r\n            width=\"120\"\r\n          />\r\n          <el-table-column label=\"操作\" align=\"center\">\r\n            <template #default=\"scope\">\r\n              <el-button\r\n                icon=\"Edit\"\r\n                link\r\n                type=\"primary\"\r\n                :disabled=\"scope.row.isExchange == 0\"\r\n                @click=\"handleUpdate(scope.row)\"\r\n                >修改\r\n              </el-button>\r\n\r\n              <el-button\r\n                icon=\"Delete\"\r\n                link\r\n                type=\"primary\"\r\n                :disabled=\"scope.row.isExchange == 0\"\r\n                @click=\"handleDelete(scope.row)\"\r\n                >删除\r\n              </el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <el-pagination\r\n          v-model:current-page=\"currentPage\"\r\n          v-model:page-size=\"pageSize\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          :small=\"small\"\r\n          :background=\"true\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"dataTotal\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          style=\"margin-top: 20px\"\r\n        />\r\n      </div>\r\n    </el-col>\r\n  </el-row>\r\n\r\n  <!-- 表单弹窗 -->\r\n  <el-dialog\r\n    v-model=\"dialogVisible\"\r\n    :title=\"formTitle\"\r\n    width=\"30%\"\r\n    :before-close=\"handleClose\"\r\n  >\r\n    <el-form\r\n      ref=\"ruleFormRef\"\r\n      :model=\"formData\"\r\n      label-width=\"100px\"\r\n      :rules=\"state.formRules\"\r\n    >\r\n      <el-row>\r\n        <el-col :span=\"20\">\r\n          <el-form-item label=\"图纸号\" prop=\"DrawingNo\">\r\n            <el-input v-model=\"formData.DrawingNo\" placeholder=\"请输入图纸号\" />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"焊口号\" prop=\"WeldNo\">\r\n            <el-input v-model=\"formData.WeldNo\" placeholder=\"请输入焊口号\" />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"管径\" prop=\"Size\">\r\n            <el-input v-model=\"formData.Size\" placeholder=\"请输入管径\" />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"材质\" prop=\"MaterialId\">\r\n            <el-select v-model=\"formData.MaterialId\" placeholder=\"请选择材质\">\r\n              <el-option label=\"CS\" value=\"CS\" />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"20\">\r\n          <el-form-item label=\"单管号\" prop=\"PipeNo\">\r\n            <el-input v-model=\"formData.PipeNo\" placeholder=\"请输入单管号\" />\r\n          </el-form-item>\r\n        </el-col>\r\n\r\n        <el-col :span=\"16\">\r\n          <el-form-item label=\"组对日期\" prop=\"ZuDuiDate\">\r\n            <el-date-picker\r\n              v-model=\"formData.ZuDuiDate\"\r\n              type=\"date\"\r\n              placeholder=\"请选择组对日期\"\r\n              style=\"width: 100%\"\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"16\">\r\n          <el-form-item label=\"组对检验日期\" prop=\"ZuDuiInspectDate\">\r\n            <el-date-picker\r\n              v-model=\"formData.ZuDuiInspectDate\"\r\n              type=\"date\"\r\n              placeholder=\"请选择组对检验日期\"\r\n              style=\"width: 100%\"\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"16\">\r\n          <el-form-item label=\"焊接日期\" prop=\"WeldingDate\">\r\n            <el-date-picker\r\n              v-model=\"formData.WeldingDate\"\r\n              type=\"date\"\r\n              placeholder=\"请选择焊接日期\"\r\n              style=\"width: 100%\"\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"16\">\r\n          <el-form-item label=\"外观检验日期\" prop=\"AppearanceInspectDate\">\r\n            <el-date-picker\r\n              v-model=\"formData.AppearanceInspectDate\"\r\n              type=\"date\"\r\n              placeholder=\"请选择外观检验日期\"\r\n              style=\"width: 100%\"\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"24\">\r\n          <el-form-item label=\"外观检验结果\" prop=\"AppearanceResult\">\r\n            <el-radio-group v-model=\"formData.AppearanceResult\">\r\n              <el-radio border :label=\"1\">合格</el-radio>\r\n              <el-radio border :label=\"2\">不合格</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n    </el-form>\r\n\r\n    <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n        <el-button\r\n          type=\"primary\"\r\n          @click=\"handleSave(ruleFormRef)\"\r\n          :loading=\"saveLoading\"\r\n        >\r\n          保存\r\n        </el-button>\r\n      </span>\r\n    </template>\r\n  </el-dialog>\r\n\r\n  <!-- 上传弹窗 -->\r\n  <el-dialog\r\n    class=\"uploadDialog\"\r\n    v-model=\"UploaddialogVisible\"\r\n    :before-close=\"handleClose\"\r\n    title=\"图纸上传\"\r\n  >\r\n    <el-upload\r\n      :action=\"action()\"\r\n      v-model:file-list=\"fileList\"\r\n      :on-change=\"changeFile\"\r\n      :before-upload=\"beforeUpload\"\r\n      list-type=\"picture\"\r\n      :data=\"uploadForm\"\r\n    >\r\n      <template #trigger>\r\n        <el-button type=\"primary\">选取文件</el-button>\r\n      </template>\r\n      <template #tip>\r\n        <div class=\"el-upload__tip\">仅支持jpg格式文件且大小大于2MB</div>\r\n      </template>\r\n    </el-upload>\r\n    <!-- <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button\r\n          type=\"primary\"\r\n          @click=\"uploadSubmit\"\r\n          :loading=\"uploadLoading\"\r\n        >\r\n          提交上传\r\n        </el-button>\r\n      </span>\r\n    </template> -->\r\n  </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n  Search,\r\n  Plus,\r\n  Edit,\r\n  Delete,\r\n  RefreshLeft,\r\n  Download,\r\n  UploadFilled,\r\n  CircleCloseFilled,\r\n} from \"@element-plus/icons-vue\";\r\nimport {\r\n  baseDataList,\r\n  dataUpdate,\r\n  drawingUpload,\r\n  dataDelete,\r\n} from \"@/Network/data.js\";\r\nimport { ElMessage, ElMessageBox, ElButton, ElDialog } from \"element-plus\";\r\nimport { reactive, ref, toRaw, toRefs } from \"vue\";\r\nimport { downLoad } from \"@/Network/index\";\r\n\r\nconst state = reactive({\r\n  tableData: [],\r\n  formData: {\r\n    DrawingNo: \"\",\r\n    WeldNo: \"\",\r\n    PipeNo: \"\",\r\n    Size: \"\",\r\n    MaterialId: \"\",\r\n    ZuDuiDate: [],\r\n    ZuDuiInspectDate: [],\r\n    WeldingDate: [],\r\n    AppearanceInspectDate: [],\r\n    AppearanceResult: \"\",\r\n  },\r\n  formRules: {\r\n    DrawingNo: [{ required: true, message: \"请输入图纸号\", trigger: \"blur\" }],\r\n    WeldNo: [{ required: true, message: \"请输入焊口号\", trigger: \"blur\" }],\r\n    // PipeNo: [{ required: true, message: \"请输入图纸号\", trigger: \"blur\" }],\r\n    // Size: \"\",\r\n    // MaterialId: \"\",\r\n    ZuDuiDate: [\r\n      {\r\n        type: \"date\",\r\n        required: true,\r\n        message: \"请选择组对日期\",\r\n        trigger: \"change\",\r\n      },\r\n    ],\r\n    // ZuDuiInspectDate: [],\r\n    WeldingDate: [\r\n      {\r\n        type: \"date\",\r\n        required: true,\r\n        message: \"请选择焊接日期\",\r\n        trigger: \"change\",\r\n      },\r\n    ],\r\n  },\r\n  uploadForm: {\r\n    user: \"test\",\r\n  },\r\n});\r\n\r\nconst { tableData, formData, uploadForm } = toRefs(state);\r\n\r\nconst allData = ref([]);\r\nconst currentPage = ref(1);\r\nconst pageSize = ref(10);\r\nconst dataTotal = ref(null);\r\nconst loading = ref(false);\r\n//获取表格数据，自行分页\r\nasync function dataListRequest() {\r\n  loading.value = true;\r\n  await baseDataList()\r\n    .then((res) => {\r\n      if (res.status === 200) {\r\n        allData.value = res.data;\r\n        dataPaging();\r\n        return Promise.resolve();\r\n      } else return Promise.reject(res);\r\n    })\r\n    .catch((erro) => {\r\n      ElMessage.error(erro);\r\n      console.log(erro);\r\n    });\r\n  loading.value = false;\r\n}\r\ndataListRequest();\r\n\r\nconst queriedList = ref(undefined);\r\n//分页\r\nfunction dataPaging(list) {\r\n  if (!queriedList.value) queriedList.value = list;\r\n  let res = queriedList.value ? queriedList.value : allData.value;\r\n  tableData.value = res.slice(\r\n    (currentPage.value - 1) * pageSize.value,\r\n    currentPage.value * pageSize.value\r\n  );\r\n  dataTotal.value = res.length;\r\n}\r\n\r\n//翻页\r\nfunction handleCurrentChange(val) {\r\n  currentPage.value = val;\r\n  dataPaging();\r\n}\r\n\r\n//页条目数改变\r\nfunction handleSizeChange(val) {\r\n  pageSize.value = val;\r\n  currentPage.value = 1;\r\n  dataPaging();\r\n}\r\n\r\n//修改弹窗\r\nconst formTitle = ref(undefined);\r\nconst rowData = ref(null);\r\nconst dialogVisible = ref(false);\r\nfunction handleUpdate(row) {\r\n  formTitle.value = \"修改表单\";\r\n  dialogVisible.value = true;\r\n  const originalData = JSON.parse(JSON.stringify(row));\r\n  formData.value = originalData;\r\n  rowData.value = originalData;\r\n}\r\n\r\n//删除\r\nfunction handleDelete(row) {\r\n  ElMessageBox.confirm(\r\n    `确定要删除图纸号为${\r\n      row.DrawingNo || selectList.value.map((item) => item.DrawingNo)\r\n    }的数据吗？`,\r\n    \"系统提示\",\r\n    {\r\n      confirmButtonText: \"确定\",\r\n      cancelButtonText: \"取消\",\r\n      type: \"warning\",\r\n    }\r\n  )\r\n    .then(() => {\r\n      dataDelete({\r\n        tableData: row,\r\n      })\r\n        .then((res) => {\r\n          console.log(res);\r\n          ElMessage({\r\n            type: \"success\",\r\n            message: \"删除成功\",\r\n          });\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    })\r\n    .catch(() => {});\r\n}\r\n\r\n//搜索\r\nconst queryData = ref(undefined);\r\nfunction handleSearch() {\r\n  queriedList.value = null;\r\n  console.log(queryData.value, \"queryDAta\");\r\n  let res = allData.value.filter(\r\n    (item) =>\r\n      item.DrawingNo == queryData.value ||\r\n      item.DrawingNo.includes(queryData.value)\r\n  );\r\n  tableData.value = res;\r\n  dataTotal.value = res.length;\r\n  dataPaging(res);\r\n}\r\n\r\n//重置表格\r\nfunction handleReset() {\r\n  queryData.value = undefined;\r\n  queriedList.value = null;\r\n  dataListRequest();\r\n}\r\n\r\n//勾选\r\nconst selectList = ref([]);\r\nfunction handleSelectionChange(selection, row) {\r\n  selectList.value = selection;\r\n}\r\n//全部勾选\r\nfunction handleSelectionAll(selection) {\r\n  selectList.value = selection;\r\n}\r\n\r\n//新增表单\r\nfunction handleAddForm() {\r\n  formTitle.value = \"新增表单\";\r\n  dialogVisible.value = true;\r\n  formData.value = {\r\n    DrawingNo: \"\",\r\n    WeldNo: \"\",\r\n    PipeNo: \"\",\r\n    Size: \"\",\r\n    MaterialId: \"\",\r\n    ZuDuiDate: [],\r\n    ZuDuiInspectDate: [],\r\n    WeldingDate: [],\r\n    AppearanceInspectDate: [],\r\n    AppearanceResult: \"\",\r\n  };\r\n}\r\n\r\n//修改保存\r\nconst ruleFormRef = ref();\r\nconst saveLoading = ref(false);\r\nasync function handleSave(formEl) {\r\n  if (!formEl) return;\r\n  await formEl.validate(async (valid, fields) => {\r\n    if (valid) {\r\n      const modifiedData = toRaw(formData.value);\r\n      modifiedData.editable = true;\r\n      for (const key in modifiedData) {\r\n        if (modifiedData[key] !== rowData.value[key]) {\r\n          modifiedData[key + \"_edible\"] = true;\r\n        } else {\r\n          modifiedData[key + \"_edible\"] = false;\r\n        }\r\n      }\r\n      modifiedData.type = \"edit\";\r\n      try {\r\n        saveLoading.value = true;\r\n        let res = await dataUpdate({\r\n          tableData: modifiedData,\r\n        });\r\n        ElMessage.success(res.data.Note);\r\n        saveLoading.value = false;\r\n        dialogVisible.value = false;\r\n        dataListRequest();\r\n      } catch (error) {\r\n        console.log(error);\r\n        ElMessage.error(error);\r\n      }\r\n    } else {\r\n      console.log(\"error submit!\", fields);\r\n    }\r\n  });\r\n}\r\n\r\n//导出\r\nfunction handleExport(url) {\r\n  downLoad(\r\n    url,\r\n    `summary_${new Date().toLocaleDateString(\"zh-CN\", {\r\n      year: \"2-digit\",\r\n      month: \"2-digit\",\r\n      day: \"2-digit\",\r\n    })}.xlsx`\r\n  );\r\n}\r\n\r\n//上传\r\nconst UploaddialogVisible = ref(false);\r\nfunction openUploadDialog() {\r\n  UploaddialogVisible.value = true;\r\n}\r\n\r\n//上传限制\r\nconst fileList = ref([]);\r\nconst beforeUpload = (rawFile) => {\r\n  if (rawFile.type !== \"image/jpeg\") {\r\n    ElMessage.error(\"文件仅支持JPG格式！\");\r\n    return false;\r\n  } else if (rawFile.size / 1024 / 1024 > 2) {\r\n    ElMessage.error(\"文件最大不能超过 2MB!\");\r\n    return false;\r\n  }\r\n  return true;\r\n};\r\n\r\nfunction changeFile(uploadFile) {\r\n  console.log(uploadFile);\r\n  fileList.value.push(uploadFile);\r\n}\r\n\r\n// function httpRequest(opt) {\r\n//   const { file, onSuccess, onFail } = opt;\r\n//   const formData = new FormData();\r\n//   formData.append(\"file\", file);\r\n//   formData.append(\"user\", \"test\");\r\n//   console.log(formData.get(\"file\"));\r\n//   // drawingUpload(formData).then((res) => console.log(res, \"res\"));\r\n// }\r\n\r\n//上传提交\r\n// const uploadLoading = ref(false);\r\n// function uploadSubmit() {\r\n//   uploadLoading.value = true;\r\n//   const jsonStr = JSON.stringify(uploadForm);\r\n//   const blob = new Blob([jsonStr], {\r\n//     type: \"application/json\",\r\n//   });\r\n//   let formData = new FormData();\r\n//   formData.append(\"obj\", blob);\r\n//   formData.append(\"file\", fileList.value[0].raw);\r\n//   console.log(formData.get(\"file\"));\r\n//   drawingUpload(formData).then((res) => {\r\n//     console.log(res);\r\n//     uploadLoading.value = false;\r\n//   });\r\n// }\r\n\r\nfunction action() {\r\n  return process.env.VUE_APP_BASE_API + \"/uploadtableimf\";\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.table-block {\r\n  margin-top: 10px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: space-around;\r\n}\r\n.my-header {\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-between;\r\n}\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=7c1ad65a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7c1ad65a\"]])\n\nexport default __exports__"],"names":["baseDataList","request","url","method","dataUpdate","formData","data","dataDelete","tableData","state","reactive","DrawingNo","WeldNo","PipeNo","Size","MaterialId","ZuDuiDate","ZuDuiInspectDate","WeldingDate","AppearanceInspectDate","AppearanceResult","formRules","required","message","trigger","type","uploadForm","user","toRefs","allData","ref","currentPage","pageSize","dataTotal","loading","async","dataListRequest","value","then","res","status","dataPaging","Promise","resolve","reject","catch","erro","ElMessage","error","console","log","queriedList","undefined","list","slice","length","handleCurrentChange","val","handleSizeChange","formTitle","rowData","dialogVisible","handleUpdate","row","originalData","JSON","parse","stringify","handleDelete","ElMessageBox","confirm","selectList","map","item","confirmButtonText","cancelButtonText","err","queryData","handleSearch","filter","includes","handleReset","handleSelectionChange","selection","handleSelectionAll","handleAddForm","ruleFormRef","saveLoading","handleSave","formEl","validate","valid","fields","modifiedData","toRaw","editable","key","success","Note","handleExport","downLoad","Date","toLocaleDateString","year","month","day","UploaddialogVisible","openUploadDialog","fileList","beforeUpload","rawFile","size","changeFile","uploadFile","push","action","process","__exports__"],"sourceRoot":""}