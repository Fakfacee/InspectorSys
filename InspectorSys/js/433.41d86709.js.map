{"version":3,"file":"js/433.41d86709.js","mappings":"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","sources":["webpack://inspector-sys/./src/Network/data.js","webpack://inspector-sys/./src/views/baseData/index.vue","webpack://inspector-sys/./src/views/baseData/index.vue?39eb"],"sourcesContent":["import request from \"./index.js\";\r\n\r\nexport function baseDataList() {\r\n  return request({\r\n    url: \"databaseget\",\r\n    method: \"get\",\r\n    // dataType: \"JSON\",\r\n    // header: {\r\n    //   \"custom-header\": \"Content-Type,Authorization\", //自定义请求头信息\r\n    // },\r\n  });\r\n}\r\n\r\n//数据更新修改\r\nexport function dataUpdate(formData) {\r\n  return request({\r\n    url: \"tableDataChange\",\r\n    method: \"post\",\r\n    data: formData,\r\n  });\r\n}\r\n\r\n//删除\r\nexport function dataDelete(tableData) {\r\n  return request({\r\n    url: \"deletetableimf\",\r\n    method: \"post\",\r\n    data: tableData,\r\n  });\r\n}\r\n\r\n//上传\r\nexport function drawingUpload(data,url) {\r\n  return request({\r\n    url: url,\r\n    method: \"post\",\r\n    data:data,\r\n    headers: {\r\n      'Content-Type':'mutipart/form-data'\r\n    },\r\n    timeout: 120000\r\n  })\r\n}\r\n","<template>\r\n  <el-row :gutter=\"30\">\r\n    <el-col :span=\"24\">\r\n      <el-form :inline=\"true\" label-width=\"55px\">\r\n        <el-form-item label=\"单管号\">\r\n          <el-input clearable style=\"width: 230px\" v-model=\"queryData\" />\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button :icon=\"Search\" type=\"primary\" @click=\"handleSearch\"\r\n            >搜索</el-button\r\n          >\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button :icon=\"RefreshLeft\" @click=\"handleReset\">重置</el-button>\r\n        </el-form-item>\r\n        <!-- <el-form-item>\r\n          <el-button :icon=\"Plus\" plain type=\"primary\" @click=\"handleAddForm\"\r\n            >新增</el-button\r\n          ></el-form-item\r\n        > -->\r\n        <el-form-item v-if=\"roles == 1\"\r\n          ><el-button\r\n            :icon=\"Edit\"\r\n            plain\r\n            type=\"success\"\r\n            :disabled=\"!(selectList.length == 1)\"\r\n            @click=\"handleUpdate(selectList[0])\"\r\n            >修改</el-button\r\n          ></el-form-item\r\n        >\r\n        <el-form-item v-if=\"roles == 1\"\r\n          ><el-button\r\n            :icon=\"Delete\"\r\n            plain\r\n            type=\"danger\"\r\n            :disabled=\"!(selectList.length >= 1)\"\r\n            @click=\"handleDelete\"\r\n            >删除</el-button\r\n          ></el-form-item\r\n        >\r\n        <el-form-item>\r\n          <el-button\r\n            :icon=\"Download\"\r\n            plain\r\n            type=\"success\"\r\n            @click=\"openDownloadDialog\"\r\n            >数据下载</el-button\r\n          >\r\n        </el-form-item>\r\n        <el-form-item v-if=\"roles == 1\">\r\n          <el-button\r\n            :icon=\"UploadFilled\"\r\n            plain\r\n            type=\"primary\"\r\n            @click=\"openUploadDialog\"\r\n            >图纸上传/升版</el-button\r\n          >\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-col>\r\n    <!-- <el-col>\r\n      <el-button\r\n        :icon=\"Download\"\r\n        plain\r\n        type=\"success\"\r\n        @click=\"openDownloadDialog\"\r\n        >数据下载</el-button\r\n      >\r\n      <el-button\r\n        :icon=\"UploadFilled\"\r\n        plain\r\n        type=\"primary\"\r\n        @click=\"openUploadDialog\"\r\n        >图纸上传</el-button\r\n      >\r\n    </el-col> -->\r\n\r\n    <el-col :span=\"24\">\r\n      <div class=\"table-block\">\r\n        <el-table\r\n          :data=\"tableData\"\r\n          v-loading=\"loading\"\r\n          element-loading-text=\"加载中...\"\r\n          @select=\"handleSelectionChange\"\r\n          @select-all=\"handleSelectionAll\"\r\n          height=\"750\"\r\n        >\r\n          <el-table-column type=\"selection\" width=\"55\" />\r\n          <el-table-column\r\n            type=\"index\"\r\n            width=\"55\"\r\n            label=\"序号\"\r\n            align=\"center\"\r\n          />\r\n          <el-table-column\r\n            label=\"图纸号\"\r\n            show-overflow-tooltip\r\n            align=\"center\"\r\n            prop=\"DrawingNo\"\r\n            width=\"220\"\r\n          />\r\n          <el-table-column\r\n            label=\"焊口号\"\r\n            show-overflow-tooltip\r\n            prop=\"WeldNo\"\r\n            align=\"center\"\r\n            width=\"80\"\r\n          />\r\n          <el-table-column\r\n            label=\"单管号\"\r\n            show-overflow-tooltip\r\n            prop=\"PipeNo\"\r\n            align=\"center\"\r\n            width=\"220\"\r\n          />\r\n          <el-table-column\r\n            label=\"管径\"\r\n            show-overflow-tooltip\r\n            prop=\"Size\"\r\n            align=\"center\"\r\n            width=\"55\"\r\n          />\r\n          <el-table-column\r\n            label=\"材质\"\r\n            show-overflow-tooltip\r\n            prop=\"MaterialId\"\r\n            align=\"center\"\r\n            width=\"55\"\r\n          />\r\n          <el-table-column\r\n            label=\"组对日期\"\r\n            show-overflow-tooltip\r\n            prop=\"ZuDuiDate\"\r\n            align=\"center\"\r\n          />\r\n          <el-table-column\r\n            label=\"组队检验日期\"\r\n            show-overflow-tooltip\r\n            prop=\"ZuDuiInspectDate\"\r\n            align=\"center\"\r\n          />\r\n          <el-table-column\r\n            label=\"焊接日期\"\r\n            show-overflow-tooltip\r\n            prop=\"WeldingDate\"\r\n            align=\"center\"\r\n          />\r\n          <el-table-column\r\n            label=\"外观检验日期\"\r\n            show-overflow-tooltip\r\n            prop=\"AppearanceInspectDate\"\r\n            align=\"center\"\r\n          />\r\n          <el-table-column\r\n            label=\"外观检验结果\"\r\n            show-overflow-tooltip\r\n            prop=\"AppearanceResult\"\r\n            align=\"center\"\r\n            width=\"120\"\r\n          />\r\n          <el-table-column label=\"操作\" align=\"center\" v-if=\"roles == 1\">\r\n            <template #default=\"scope\">\r\n              <el-button\r\n                icon=\"Edit\"\r\n                link\r\n                type=\"primary\"\r\n                :disabled=\"scope.row.isExchange == 0\"\r\n                @click=\"handleUpdate(scope.row)\"\r\n                >修改\r\n              </el-button>\r\n\r\n              <el-button\r\n                icon=\"Delete\"\r\n                link\r\n                type=\"primary\"\r\n                :disabled=\"scope.row.isExchange == 0\"\r\n                @click=\"handleDelete(scope.row)\"\r\n                >删除\r\n              </el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <el-pagination\r\n          v-model:current-page=\"currentPage\"\r\n          v-model:page-size=\"pageSize\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          :small=\"small\"\r\n          :background=\"true\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"dataTotal\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          style=\"margin-top: 20px\"\r\n        />\r\n      </div>\r\n    </el-col>\r\n  </el-row>\r\n\r\n  <!-- 表单弹窗 -->\r\n  <el-dialog v-model=\"dialogVisible\" :title=\"formTitle\" width=\"30%\">\r\n    <el-form\r\n      ref=\"ruleFormRef\"\r\n      :model=\"formData\"\r\n      label-width=\"100px\"\r\n      :rules=\"state.formRules\"\r\n    >\r\n      <el-row>\r\n        <el-col :span=\"20\">\r\n          <el-form-item label=\"图纸号\" prop=\"DrawingNo\">\r\n            <el-input v-model=\"formData.DrawingNo\" placeholder=\"请输入图纸号\" />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"焊口号\" prop=\"WeldNo\">\r\n            <el-input v-model=\"formData.WeldNo\" placeholder=\"请输入焊口号\" />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"管径\" prop=\"Size\">\r\n            <el-input v-model=\"formData.Size\" placeholder=\"请输入管径\" />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"材质\" prop=\"MaterialId\">\r\n            <el-select v-model=\"formData.MaterialId\" placeholder=\"请选择材质\">\r\n              <el-option label=\"CS\" value=\"CS\" />\r\n              <el-option label=\"SS\" value=\"SS\" />\r\n              <el-option label=\"CU/NI\" value=\"CU/NI\" />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"20\">\r\n          <el-form-item label=\"单管号\" prop=\"PipeNo\">\r\n            <el-input v-model=\"formData.PipeNo\" placeholder=\"请输入单管号\" />\r\n          </el-form-item>\r\n        </el-col>\r\n\r\n        <el-col :span=\"16\">\r\n          <el-form-item label=\"组对日期\" prop=\"ZuDuiDate\">\r\n            <el-date-picker\r\n              v-model=\"formData.ZuDuiDate\"\r\n              type=\"date\"\r\n              value-format=\"YYYY-MM-DD\"\r\n              placeholder=\"请选择组对日期\"\r\n              style=\"width: 100%\"\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"16\">\r\n          <el-form-item label=\"组对检验日期\" prop=\"ZuDuiInspectDate\">\r\n            <el-date-picker\r\n              v-model=\"formData.ZuDuiInspectDate\"\r\n              type=\"date\"\r\n              value-format=\"YYYY-MM-DD\"\r\n              placeholder=\"请选择组对检验日期\"\r\n              style=\"width: 100%\"\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"16\">\r\n          <el-form-item label=\"焊接日期\" prop=\"WeldingDate\">\r\n            <el-date-picker\r\n              v-model=\"formData.WeldingDate\"\r\n              type=\"date\"\r\n              value-format=\"YYYY-MM-DD\"\r\n              placeholder=\"请选择焊接日期\"\r\n              style=\"width: 100%\"\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"16\">\r\n          <el-form-item label=\"外观检验日期\" prop=\"AppearanceInspectDate\">\r\n            <el-date-picker\r\n              v-model=\"formData.AppearanceInspectDate\"\r\n              type=\"date\"\r\n              placeholder=\"请选择外观检验日期\"\r\n              value-format=\"YYYY-MM-DD\"\r\n              style=\"width: 100%\"\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"24\">\r\n          <el-form-item label=\"外观检验结果\" prop=\"AppearanceResult\">\r\n            <el-radio-group v-model=\"formData.AppearanceResult\">\r\n              <el-radio border :label=\"1\">合格</el-radio>\r\n              <el-radio border :label=\"2\">不合格</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n    </el-form>\r\n\r\n    <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n        <el-button\r\n          type=\"primary\"\r\n          @click=\"handleSave(ruleFormRef)\"\r\n          :loading=\"saveLoading\"\r\n        >\r\n          保存\r\n        </el-button>\r\n      </span>\r\n    </template>\r\n  </el-dialog>\r\n\r\n  <!-- 上传弹窗 -->\r\n  <el-dialog\r\n    class=\"uploadDialog\"\r\n    v-model=\"UploaddialogVisible\"\r\n    title=\"图纸上传\"\r\n  >\r\n    <el-upload\r\n      ref=\"uploadRef\"\r\n      class=\"upload-demo\"\r\n      :on-change=\"onChange\"\r\n      :on-exceed=\"onExceed\"\r\n      list-type=\"picture\"\r\n      :auto-upload=\"false\"\r\n      limit=\"1\"\r\n      :file-list=\"fileList\"\r\n    >\r\n      <template #trigger>\r\n        <el-button type=\"primary\">选取文件</el-button>\r\n      </template>\r\n      <template #tip>\r\n        <div class=\"el-upload__tip\">仅能上传xlsx文件</div>\r\n      </template>\r\n    </el-upload>\r\n    <template #footer>\r\n      <el-button\r\n        @click=\"submitUpload('drawingchange')\"\r\n        :disabled=\"uploadLoading\"\r\n        >升版</el-button\r\n      >\r\n      <el-button\r\n        type=\"success\"\r\n        @click=\"submitUpload('uploadtableimf')\"\r\n        :loading=\"uploadLoading\"\r\n        >{{ uploadLoading ? \"上传中...\" : \"上传\" }}</el-button\r\n      >\r\n    </template>\r\n  </el-dialog>\r\n\r\n  <!-- 下载弹窗 -->\r\n  <el-dialog v-model=\"downLoadDialog\" title=\"数据下载\" width=\"600\">\r\n    <el-row :justify=\"center\">\r\n      <el-col :span=\"24\">\r\n        <el-form :inline=\"true\">\r\n          <el-form-item label=\"时间范围\">\r\n            <el-date-picker\r\n              v-model=\"dateValue\"\r\n              type=\"daterange\"\r\n              unlink-panels\r\n              range-separator=\"至\"\r\n              start-placeholder=\"开始时间\"\r\n              end-placeholder=\"结束时间\"\r\n              :shortcuts=\"shortcuts\"\r\n              value-format=\"YYYY-MM-DD\"\r\n              :disabled-date=\"disabledDate\"\r\n            />\r\n          </el-form-item>\r\n        </el-form>\r\n      </el-col>\r\n      <el-col :span=\"24\">\r\n        <el-alert\r\n          title=\"下载VT信息时，时间为必选值\"\r\n          type=\"warning\"\r\n          show-icon\r\n          :closable=\"false\"\r\n      /></el-col>\r\n      <el-col :span=\"24\">\r\n        <el-table :data=\"downLoadTableData\">\r\n          <el-table-column\r\n            label=\"数据名称\"\r\n            prop=\"name\"\r\n            show-overflow-tooltip\r\n            align=\"center\"\r\n          />\r\n          <el-table-column label=\"操作\" align=\"center\">\r\n            <template #default=\"scope\">\r\n              <el-button\r\n                link\r\n                :icon=\"Download\"\r\n                type=\"primary\"\r\n                @click=\"handleExport(scope.row)\"\r\n                >下载\r\n              </el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </el-col>\r\n    </el-row>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n  Search,\r\n  Plus,\r\n  Edit,\r\n  Delete,\r\n  RefreshLeft,\r\n  Download,\r\n  UploadFilled,\r\n} from \"@element-plus/icons-vue\";\r\nimport {\r\n  baseDataList,\r\n  dataUpdate,\r\n  drawingUpload,\r\n  dataDelete,\r\n} from \"@/Network/data.js\";\r\nimport {\r\n  ElMessage,\r\n  ElMessageBox,\r\n  ElButton,\r\n  ElDialog,\r\n  ElNotification,\r\n} from \"element-plus\";\r\nimport { reactive, ref, toRaw, toRefs, h } from \"vue\";\r\nimport { downLoad } from \"@/Network/index\";\r\n\r\nconst roles = sessionStorage.getItem(\"roles\");\r\nconsole.log(roles);\r\nconst state = reactive({\r\n  tableData: [],\r\n  formData: {\r\n    DrawingNo: \"\",\r\n    WeldNo: \"\",\r\n    PipeNo: \"\",\r\n    Size: \"\",\r\n    MaterialId: \"\",\r\n    ZuDuiDate: [],\r\n    ZuDuiInspectDate: [],\r\n    WeldingDate: [],\r\n    AppearanceInspectDate: [],\r\n    AppearanceResult: \"\",\r\n    Contractor: \"\",\r\n    Fitter: \"\",\r\n    Inspector: \"\",\r\n    JointType: \"\",\r\n    Location: \"\",\r\n    ModuleNo: \"\",\r\n    Thickness: \"\",\r\n    WPS: \"\",\r\n    WeldId: \"\",\r\n    WelderNo: \"\",\r\n    WorkPackage: \"\",\r\n    ZuDuiId: \"\",\r\n    ZuDuiResult: \"\",\r\n  },\r\n  formRules: {\r\n    DrawingNo: [{ required: true, message: \"请输入图纸号\", trigger: \"blur\" }],\r\n    WeldNo: [{ required: true, message: \"请输入焊口号\", trigger: \"blur\" }],\r\n  },\r\n  uploadForm: {\r\n    user: \"test\",\r\n  },\r\n  downLoadTableData: [\r\n    {\r\n      name: \"DWR\",\r\n      key: \"downloaddwrfile\",\r\n    },\r\n    {\r\n      name: \"焊口信息汇总表\",\r\n      key: \"downloadsumfile\",\r\n    },\r\n    {\r\n      name: \"VT信息\",\r\n      key: \"downloadvtfile\",\r\n    },\r\n  ],\r\n});\r\n\r\nconst { tableData, formData, uploadForm, downLoadTableData } = toRefs(state);\r\n\r\nconst allData = ref([]);\r\nconst currentPage = ref(1);\r\nconst pageSize = ref(10);\r\nconst dataTotal = ref(null);\r\nconst loading = ref(false);\r\n//获取表格数据，自行分页\r\nasync function dataListRequest() {\r\n  loading.value = true;\r\n  await baseDataList()\r\n    .then((res) => {\r\n      if (res.status === 200) {\r\n        // console.log(res.data,'dataListRequest');\r\n        allData.value = res.data;\r\n        dataPaging();\r\n        return Promise.resolve();\r\n      } else return Promise.reject(res);\r\n    })\r\n    .catch((erro) => {\r\n      ElMessage.error(erro);\r\n      console.log(erro);\r\n    });\r\n  loading.value = false;\r\n}\r\ndataListRequest();\r\n\r\nconst queriedList = ref(undefined);\r\n//分页\r\nfunction dataPaging(list) {\r\n  if (!queriedList.value) queriedList.value = list;\r\n  let res = queriedList.value ? queriedList.value : allData.value;\r\n  tableData.value = res.slice(\r\n    (currentPage.value - 1) * pageSize.value,\r\n    currentPage.value * pageSize.value\r\n  );\r\n  dataTotal.value = res.length;\r\n}\r\n\r\n//翻页\r\nfunction handleCurrentChange(val) {\r\n  currentPage.value = val;\r\n  dataPaging();\r\n}\r\n\r\n//页条目数改变\r\nfunction handleSizeChange(val) {\r\n  pageSize.value = val;\r\n  currentPage.value = 1;\r\n  dataPaging();\r\n}\r\n\r\n//修改弹窗\r\nconst formTitle = ref(undefined);\r\nconst rowData = ref(null);\r\nconst dialogVisible = ref(false);\r\nfunction handleUpdate(row) {\r\n  formTitle.value = \"修改表单\";\r\n  dialogVisible.value = true;\r\n  const originalData = JSON.parse(JSON.stringify(row));\r\n  formData.value = originalData;\r\n  rowData.value = originalData;\r\n}\r\n\r\n//删除\r\nfunction handleDelete(row) {\r\n  ElMessageBox.confirm(\r\n    `确定要删除图纸号为${\r\n      row.DrawingNo || selectList.value.map((item) => item.DrawingNo)\r\n    }的数据吗？`,\r\n    \"系统提示\",\r\n    {\r\n      confirmButtonText: \"确定\",\r\n      cancelButtonText: \"取消\",\r\n      type: \"warning\",\r\n    }\r\n  )\r\n    .then(() => {\r\n      dataDelete({\r\n        tableData: row,\r\n      })\r\n        .then((res) => {\r\n          console.log(res);\r\n          ElMessage({\r\n            type: \"success\",\r\n            message: \"删除成功\",\r\n          });\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    })\r\n    .catch(() => {});\r\n}\r\n\r\n//搜索\r\nconst queryData = ref(undefined);\r\nfunction handleSearch() {\r\n  queriedList.value = null;\r\n  console.log(queryData.value, \"queryDAta\");\r\n  let res = allData.value.filter(\r\n    (item) =>\r\n      item.DrawingNo == queryData.value ||\r\n      item.DrawingNo.includes(queryData.value)\r\n  );\r\n  tableData.value = res;\r\n  dataTotal.value = res.length;\r\n  dataPaging(res);\r\n}\r\n\r\n//重置表格\r\nfunction handleReset() {\r\n  queryData.value = undefined;\r\n  queriedList.value = null;\r\n  dataListRequest();\r\n}\r\n\r\n//勾选\r\nconst selectList = ref([]);\r\nfunction handleSelectionChange(selection, row) {\r\n  selectList.value = selection;\r\n}\r\n//全部勾选\r\nfunction handleSelectionAll(selection) {\r\n  selectList.value = selection;\r\n}\r\n\r\n//新增表单\r\n// function handleAddForm() {\r\n//   formTitle.value = \"新增表单\";\r\n//   dialogVisible.value = true;\r\n//   formData.value = {\r\n//     DrawingNo: \"\",\r\n//     WeldNo: \"\",\r\n//     PipeNo: \"\",\r\n//     Size: \"\",\r\n//     MaterialId: \"\",\r\n//     ZuDuiDate: [],\r\n//     ZuDuiInspectDate: [],\r\n//     WeldingDate: [],\r\n//     AppearanceInspectDate: [],\r\n//     AppearanceResult: \"\",\r\n//   };\r\n// }\r\n\r\n//修改保存\r\nconst ruleFormRef = ref();\r\nconst saveLoading = ref(false);\r\nasync function handleSave(formEl) {\r\n  if (!formEl) return;\r\n  await formEl.validate(async (valid, fields) => {\r\n    if (valid) {\r\n      const modifiedData = toRaw(formData.value);\r\n      console.log(formData.value);\r\n\r\n      // modifiedData.editable = true;\r\n      // for (const key in modifiedData) {\r\n      //   if (modifiedData[key] !== rowData.value[key]) {\r\n      //     modifiedData[key + \"_edible\"] = true;\r\n      //   } else {\r\n      //     modifiedData[key + \"_edible\"] = false;\r\n      //   }\r\n      // }\r\n      // modifiedData.type = \"edit\";\r\n\r\n      try {\r\n        saveLoading.value = true;\r\n        let res = await dataUpdate({\r\n          tableData: modifiedData,\r\n        });\r\n        ElMessage.success(res.data.Note);\r\n        saveLoading.value = false;\r\n        dialogVisible.value = false;\r\n        dataListRequest();\r\n      } catch (error) {\r\n        console.log(error);\r\n        ElMessage.error(error);\r\n      }\r\n    } else {\r\n      console.log(\"error submit!\", fields);\r\n    }\r\n  });\r\n}\r\n\r\n//下载窗口\r\nconst downLoadDialog = ref(false);\r\nfunction openDownloadDialog() {\r\n  downLoadDialog.value = true;\r\n}\r\n//下载\r\nfunction handleExport(row) {\r\n  if (!dateValue.value) {\r\n    if(row.key == 'downloadvtfile'){\r\n      ElMessage.error('请选择时间范围')\r\n      return\r\n    }\r\n    downLoad(\r\n      row.key,\r\n      `summary_${new Date().toLocaleDateString(\"zh-CN\", {\r\n        year: \"2-digit\",\r\n        month: \"2-digit\",\r\n        day: \"2-digit\",\r\n      })}.xlsx`\r\n    );\r\n  } else {\r\n    ElMessageBox.confirm(\r\n      `是否下载截至时间为${dateValue.value[0]}至${dateValue.value[1]}的${row.name}数据?`,\r\n      \"提示\",\r\n      {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\",\r\n      }\r\n    )\r\n      .then(() => {\r\n        let date = {\r\n          StartDate: dateValue.value[0],\r\n          EndDate: dateValue.value[1],\r\n        };\r\n        downLoad(\r\n          row.key,\r\n          `summary_${new Date().toLocaleDateString(\"zh-CN\", {\r\n            year: \"2-digit\",\r\n            month: \"2-digit\",\r\n            day: \"2-digit\",\r\n          })}.xlsx`,\r\n          JSON.stringify(date)\r\n        )\r\n      })\r\n      .catch(() => {\r\n      });\r\n  }\r\n}\r\n\r\n//上传窗口\r\nconst UploaddialogVisible = ref(false);\r\nfunction openUploadDialog() {\r\n  UploaddialogVisible.value = true;\r\n}\r\n\r\n//上传格式限制\r\nconst file = ref();\r\nconst fileList = ref([]);\r\nfunction onChange(fileRaw) {\r\n  file.value = fileRaw;\r\n  let name = fileRaw.name.split(\".\");\r\n  if (name[1] === \"xls\" || name[1] === \"xlsx\" || name[1] === \"csv\") {\r\n    return fileRaw;\r\n  } else {\r\n    ElNotification({\r\n      title: \"上传失败\",\r\n      message: `仅能上传excel格式文件！`,\r\n      type: \"error\",\r\n    });\r\n    fileList.value = [];\r\n    file.value = \"\";\r\n    return false;\r\n  }\r\n}\r\n\r\n//上传次数限制钩子\r\nfunction onExceed() {\r\n  ElNotification({\r\n    title: \"上传失败\",\r\n    message: `单次仅能上传一个文件！`,\r\n    type: \"error\",\r\n  });\r\n}\r\n\r\n//上传新文件按钮/升版\r\nconst uploadLoading = ref(false);\r\nconst uploadRef = ref();\r\nfunction submitUpload(key) {\r\n  if (!file.value) {\r\n    ElMessage.error(\"上传文件不能为空！\");\r\n    return;\r\n  }\r\n  uploadLoading.value = true;\r\n  let formData = new FormData();\r\n  formData.append(\"file\", file.value.raw);\r\n  formData.append(\"user\", \"test\");\r\n  drawingUpload(formData, key)\r\n    .then((res) => {\r\n      ElNotification({\r\n        title: \"上传成功\",\r\n        message: `${res.data.Note}`,\r\n        type: \"success\",\r\n      });\r\n      uploadLoading.value = false;\r\n      fileList.value = [];\r\n      file.value = \"\";\r\n    })\r\n    .catch((error) => {\r\n      ElNotification({\r\n        title: \"上传失败\",\r\n        message: `错误，请联系管理员`,\r\n        type: \"error\",\r\n      });\r\n    });\r\n}\r\n\r\n//时间范围\r\nconst dateValue = ref();\r\nconst shortcuts = [\r\n  {\r\n    text: \"上周\",\r\n    value: () => {\r\n      const end = new Date();\r\n      const start = new Date();\r\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);\r\n      return [start, end];\r\n    },\r\n  },\r\n  {\r\n    text: \"上个月\",\r\n    value: () => {\r\n      const end = new Date();\r\n      const start = new Date();\r\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);\r\n      return [start, end];\r\n    },\r\n  },\r\n  {\r\n    text: \"3个月之前\",\r\n    value: () => {\r\n      const end = new Date();\r\n      const start = new Date();\r\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);\r\n      return [start, end];\r\n    },\r\n  },\r\n];\r\nfunction disabledDate(date) {\r\n  return date.getTime() > Date.now();\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.table-block {\r\n  margin-top: 10px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: space-around;\r\n}\r\n.my-header {\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-between;\r\n}\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=47cd97fa&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-47cd97fa\"]])\n\nexport default __exports__"],"names":["baseDataList","request","url","method","dataUpdate","formData","data","dataDelete","tableData","drawingUpload","headers","timeout","roles","sessionStorage","getItem","console","log","state","reactive","DrawingNo","WeldNo","PipeNo","Size","MaterialId","ZuDuiDate","ZuDuiInspectDate","WeldingDate","AppearanceInspectDate","AppearanceResult","Contractor","Fitter","Inspector","JointType","Location","ModuleNo","Thickness","WPS","WeldId","WelderNo","WorkPackage","ZuDuiId","ZuDuiResult","formRules","required","message","trigger","uploadForm","user","downLoadTableData","name","key","toRefs","allData","ref","currentPage","pageSize","dataTotal","loading","async","dataListRequest","value","then","res","status","dataPaging","Promise","resolve","reject","catch","erro","ElMessage","error","queriedList","undefined","list","slice","length","handleCurrentChange","val","handleSizeChange","formTitle","rowData","dialogVisible","handleUpdate","row","originalData","JSON","parse","stringify","handleDelete","ElMessageBox","confirm","selectList","map","item","confirmButtonText","cancelButtonText","type","err","queryData","handleSearch","filter","includes","handleReset","handleSelectionChange","selection","handleSelectionAll","ruleFormRef","saveLoading","handleSave","formEl","validate","valid","fields","modifiedData","toRaw","success","Note","downLoadDialog","openDownloadDialog","handleExport","dateValue","date","StartDate","EndDate","downLoad","Date","toLocaleDateString","year","month","day","UploaddialogVisible","openUploadDialog","file","fileList","onChange","fileRaw","split","ElNotification","title","onExceed","uploadLoading","uploadRef","submitUpload","FormData","append","raw","shortcuts","text","end","start","setTime","getTime","disabledDate","now","__exports__"],"sourceRoot":""}